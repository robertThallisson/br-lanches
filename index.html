<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>NR Lanchonete | Card√°pio Digital</title>
  <meta name="description" content="Fa√ßa seu pedido online na NR Lanchonete. Os melhores lanches, bebidas e sobremesas da regi√£o!" />
  <meta name="theme-color" content="#4b1626" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --background: #0b0205;
      --foreground: #f5e6ea;
      --card: #1a0a10;
      --card-hover: #2b0f18;
      --primary: #4b1626;
      --primary-light: #7a2a40;
      --secondary: #2b1520;
      --muted: #3d1a28;
      --muted-foreground: #b89aa5;
      --pink-soft: #ffdde5;
      --pink-accent: #ffb6c1;
      --orange: #ff9800;
      --orange-light: #ffb74d;
      --border: #3d1a28;
      --shadow: rgba(0, 0, 0, 0.4);
      --glass: rgba(75, 22, 38, 0.85);
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      background: var(--background);
      color: var(--foreground);
      min-height: 100vh;
      -webkit-font-smoothing: antialiased;
    }

    /* ========== HEADER ========== */
    .header {
      position: sticky;
      top: 0;
      z-index: 100;
      background: linear-gradient(180deg, #2b1520 0%, #1a0a10 100%);
      border-bottom: 1px solid var(--border);
      box-shadow: 0 4px 20px var(--shadow);
    }

    .header-content {
      max-width: 1200px;
      margin: 0 auto;
      padding: 16px 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .logo-section {
      display: flex;
      align-items: center;
      gap: 14px;
    }

    .logo-icon {
      width: 56px;
      height: 56px;
      border-radius: 50%;
      background: var(--pink-soft);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 32px;
      box-shadow: 0 4px 16px var(--shadow);
      transition: transform 0.2s;
    }

    .logo-icon:hover {
      transform: scale(1.05);
    }

    .logo-text h1 {
      font-size: 20px;
      font-weight: 700;
      color: var(--foreground);
    }

    .logo-text p {
      font-size: 13px;
      color: var(--pink-accent);
    }

    .cart-button {
      position: relative;
      background: linear-gradient(135deg, var(--primary) 0%, #3d1520 100%);
      border: 1px solid var(--primary-light);
      border-radius: 50%;
      width: 48px;
      height: 48px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
      box-shadow: 0 4px 16px var(--shadow);
    }

    .cart-button:hover {
      transform: scale(1.05);
      box-shadow: 0 6px 20px var(--shadow);
    }

    .cart-button svg {
      width: 24px;
      height: 24px;
      color: var(--pink-soft);
    }

    .cart-badge {
      position: absolute;
      top: -4px;
      right: -4px;
      background: linear-gradient(135deg, var(--orange) 0%, #e68900 100%);
      color: #000;
      font-size: 12px;
      font-weight: 700;
      min-width: 22px;
      height: 22px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      transform: scale(0);
      transition: transform 0.2s;
    }

    .cart-badge.show {
      transform: scale(1);
    }

    /* ========== CATEGORIES ========== */
    .categories {
      position: sticky;
      top: 88px;
      z-index: 90;
      background: rgba(11, 2, 5, 0.9);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border-bottom: 1px solid var(--border);
      padding: 12px 20px;
    }

    .categories-inner {
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      gap: 10px;
      overflow-x: auto;
      scrollbar-width: none;
      -ms-overflow-style: none;
    }

    .categories-inner::-webkit-scrollbar {
      display: none;
    }

    .category-btn {
      flex-shrink: 0;
      padding: 10px 18px;
      border-radius: 50px;
      border: none;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      gap: 8px;
      background: var(--secondary);
      color: var(--muted-foreground);
    }

    .category-btn:hover {
      color: var(--foreground);
      background: var(--muted);
    }

    .category-btn.active {
      background: linear-gradient(135deg, var(--primary) 0%, #3d1520 100%);
      color: var(--pink-soft);
      border: 1px solid var(--primary-light);
      box-shadow: 0 4px 16px var(--shadow);
    }

    /* ========== MENU LIST ========== */
    .menu-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 24px 20px 140px;
    }

    .menu-list {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    /* ========== MENU CARD ========== */
    .menu-card {
      background: linear-gradient(180deg, #1a0a10 0%, #140810 100%);
      border-radius: 16px;
      overflow: hidden;
      border: 1px solid var(--border);
      box-shadow: 0 8px 32px var(--shadow);
      display: flex;
      transition: border-color 0.3s, transform 0.2s;
      animation: fadeIn 0.4s ease-out;
    }

    .menu-card:hover {
      border-color: var(--primary-light);
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .card-emoji {
      width: 100px;
      min-height: 100%;
      background: linear-gradient(135deg, var(--primary) 0%, #3d1520 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 48px;
    }

    .card-content {
      flex: 1;
      padding: 16px;
    }

    .card-category {
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      color: var(--pink-accent);
      margin-bottom: 4px;
    }

    .card-name {
      font-size: 18px;
      font-weight: 700;
      color: var(--foreground);
      margin-bottom: 6px;
    }

    .card-description {
      font-size: 13px;
      color: var(--muted-foreground);
      line-height: 1.4;
      margin-bottom: 12px;
    }

    .price-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 8px;
    }

    .price {
      font-size: 18px;
      font-weight: 700;
      color: var(--pink-soft);
    }

    .price.combo {
      color: var(--orange);
    }

    .combo-description {
      font-size: 12px;
      color: var(--orange-light);
      font-style: italic;
      margin-bottom: 8px;
    }

    .combo-separator {
      border-top: 1px solid var(--border);
      padding-top: 12px;
      margin-top: 4px;
    }

    .add-btn {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 10px 18px;
      border-radius: 50px;
      border: none;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
    }

    .add-btn:hover {
      transform: scale(1.05);
    }

    .add-btn:active {
      transform: scale(0.95);
    }

    .add-btn.normal {
      background: var(--pink-soft);
      color: #3d1520;
      box-shadow: 0 4px 16px var(--shadow);
    }

    .add-btn.combo {
      background: linear-gradient(135deg, var(--orange) 0%, #e68900 100%);
      color: #000;
      box-shadow: 0 4px 16px var(--shadow);
    }

    .add-btn svg {
      width: 16px;
      height: 16px;
    }

    /* ========== FLOATING CART ========== */
    .floating-cart {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      padding: 16px 20px;
      background: var(--glass);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border-top: 1px solid var(--border);
      z-index: 100;
      transform: translateY(100%);
      transition: transform 0.3s ease-out;
    }

    .floating-cart.show {
      transform: translateY(0);
    }

    .floating-cart-btn {
      width: 100%;
      max-width: 600px;
      margin: 0 auto;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 16px 24px;
      background: linear-gradient(135deg, var(--primary) 0%, #3d1520 100%);
      border: 1px solid var(--primary-light);
      border-radius: 16px;
      cursor: pointer;
      box-shadow: 0 4px 16px var(--shadow);
      transition: transform 0.2s;
    }

    .floating-cart-btn:hover {
      transform: scale(1.02);
    }

    .floating-cart-left {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .floating-cart-icon {
      position: relative;
    }

    .floating-cart-icon svg {
      width: 24px;
      height: 24px;
      color: var(--pink-soft);
    }

    .floating-cart-badge {
      position: absolute;
      top: -8px;
      right: -8px;
      background: linear-gradient(135deg, var(--orange) 0%, #e68900 100%);
      color: #000;
      font-size: 11px;
      font-weight: 700;
      min-width: 20px;
      height: 20px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .floating-cart-text {
      font-size: 16px;
      font-weight: 600;
      color: var(--pink-soft);
    }

    .floating-cart-total {
      font-size: 18px;
      font-weight: 700;
      color: var(--pink-soft);
    }

    /* ========== CART VIEW ========== */
    .cart-view {
      display: none;
      min-height: 100vh;
      padding-bottom: 140px;
    }

    .cart-view.show {
      display: block;
    }

    .menu-view.hide {
      display: none;
    }

    .cart-header {
      position: sticky;
      top: 0;
      z-index: 100;
      background: linear-gradient(180deg, #2b1520 0%, #1a0a10 100%);
      border-bottom: 1px solid var(--border);
      padding: 16px 20px;
    }

    .cart-header-content {
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      align-items: center;
      gap: 16px;
    }

    .back-btn {
      width: 44px;
      height: 44px;
      border-radius: 50%;
      background: var(--secondary);
      border: none;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: background 0.2s;
    }

    .back-btn:hover {
      background: var(--muted);
    }

    .back-btn svg {
      width: 20px;
      height: 20px;
      color: var(--foreground);
    }

    .cart-header h2 {
      font-size: 20px;
      font-weight: 700;
    }

    .cart-header p {
      font-size: 13px;
      color: var(--muted-foreground);
    }

    .cart-content {
      max-width: 600px;
      margin: 0 auto;
      padding: 24px 20px;
    }

    .cart-section {
      background: linear-gradient(180deg, #1a0a10 0%, #140810 100%);
      border-radius: 16px;
      border: 1px solid var(--border);
      padding: 16px;
      margin-bottom: 16px;
    }

    .cart-section-title {
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 16px;
      font-weight: 700;
      margin-bottom: 16px;
    }

    .cart-section-title svg {
      width: 20px;
      height: 20px;
      color: var(--pink-accent);
    }

    /* Cart Item */
    .cart-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      padding: 12px 0;
      border-bottom: 1px solid var(--border);
    }

    .cart-item:last-child {
      border-bottom: none;
    }

    .cart-item-info {
      flex: 1;
      min-width: 0;
    }

    .cart-item-name {
      font-weight: 600;
      font-size: 15px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .cart-item-combo-badge {
      display: inline-block;
      padding: 2px 8px;
      border-radius: 50px;
      font-size: 11px;
      font-weight: 600;
      background: linear-gradient(135deg, var(--orange) 0%, #e68900 100%);
      color: #000;
      margin-top: 4px;
    }

    .cart-item-unit-price {
      font-size: 13px;
      color: var(--muted-foreground);
      margin-top: 4px;
    }

    .cart-item-actions {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .qty-btn {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      border: none;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 18px;
      transition: transform 0.2s, background 0.2s;
    }

    .qty-btn:hover {
      transform: scale(1.1);
    }

    .qty-btn:active {
      transform: scale(0.9);
    }

    .qty-btn.minus {
      background: var(--secondary);
      color: var(--foreground);
    }

    .qty-btn.minus.delete {
      background: rgba(220, 38, 38, 0.2);
      color: #ef4444;
    }

    .qty-btn.plus {
      background: var(--pink-soft);
      color: #3d1520;
    }

    .qty-value {
      width: 32px;
      text-align: center;
      font-size: 18px;
      font-weight: 700;
    }

    .cart-item-subtotal {
      min-width: 80px;
      text-align: right;
      font-size: 16px;
      font-weight: 700;
      color: var(--pink-soft);
    }

    /* Option Buttons */
    .options-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
    }

    .options-grid.three {
      grid-template-columns: repeat(3, 1fr);
    }

    .option-btn {
      padding: 16px 12px;
      border-radius: 12px;
      border: 2px solid var(--border);
      background: transparent;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
    }

    .option-btn:hover {
      border-color: var(--primary-light);
    }

    .option-btn.active {
      border-color: var(--pink-accent);
      background: rgba(255, 182, 193, 0.1);
    }

    .option-btn svg {
      width: 24px;
      height: 24px;
      color: var(--muted-foreground);
    }

    .option-btn.active svg {
      color: var(--pink-accent);
    }

    .option-btn span {
      font-size: 14px;
      font-weight: 600;
      color: var(--foreground);
    }

    .option-btn.active span {
      color: var(--pink-accent);
    }

    /* Troco Input */
    .troco-input {
      width: 100%;
      margin-top: 16px;
      padding: 14px 16px;
      border-radius: 12px;
      border: 1px solid var(--border);
      background: var(--secondary);
      color: var(--foreground);
      font-size: 15px;
      font-family: inherit;
      transition: border-color 0.2s;
      display: none;
    }

    .troco-input.show {
      display: block;
    }

    .troco-input:focus {
      outline: none;
      border-color: var(--pink-accent);
    }

    .troco-input::placeholder {
      color: var(--muted-foreground);
    }

    /* Totals */
    .total-row {
      display: flex;
      justify-content: space-between;
      font-size: 15px;
      color: var(--muted-foreground);
      margin-bottom: 12px;
    }

    .total-row.main {
      padding-top: 12px;
      border-top: 1px solid var(--border);
      margin-bottom: 0;
    }

    .total-row.main span:first-child {
      font-size: 18px;
      font-weight: 700;
      color: var(--foreground);
    }

    .total-row.main span:last-child {
      font-size: 24px;
      font-weight: 700;
      color: var(--pink-soft);
    }

    .frete-row {
      display: none;
    }

    .frete-row.show {
      display: flex;
    }

    /* Finalize Button */
    .finalize-bar {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      padding: 16px 20px;
      background: var(--glass);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border-top: 1px solid var(--border);
      z-index: 100;
    }

    .finalize-btn {
      width: 100%;
      max-width: 600px;
      margin: 0 auto;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      padding: 18px 24px;
      background: linear-gradient(135deg, var(--primary) 0%, #3d1520 100%);
      border: 1px solid var(--primary-light);
      border-radius: 16px;
      font-size: 18px;
      font-weight: 700;
      color: var(--foreground);
      cursor: pointer;
      box-shadow: 0 4px 16px var(--shadow);
      transition: transform 0.2s, opacity 0.2s;
    }

    .finalize-btn:hover {
      opacity: 0.9;
    }

    .finalize-btn:active {
      transform: scale(0.98);
    }

    .finalize-btn svg {
      width: 24px;
      height: 24px;
    }

    /* Empty Cart */
    .empty-cart {
      display: none;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 60vh;
      padding: 40px 20px;
      text-align: center;
    }

    .empty-cart.show {
      display: flex;
    }

    .empty-cart-icon {
      width: 96px;
      height: 96px;
      border-radius: 50%;
      background: var(--secondary);
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 24px;
      animation: bounce 2s infinite;
    }

    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }

    .empty-cart-icon svg {
      width: 48px;
      height: 48px;
      color: var(--muted-foreground);
    }

    .empty-cart h3 {
      font-size: 20px;
      font-weight: 700;
      margin-bottom: 8px;
    }

    .empty-cart p {
      color: var(--muted-foreground);
      margin-bottom: 24px;
    }

    .empty-cart-btn {
      padding: 14px 28px;
      border-radius: 50px;
      background: linear-gradient(135deg, var(--primary) 0%, #3d1520 100%);
      border: 1px solid var(--primary-light);
      color: var(--pink-soft);
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      box-shadow: 0 4px 16px var(--shadow);
      transition: transform 0.2s;
    }

    .empty-cart-btn:hover {
      transform: scale(1.05);
    }

    /* SVG Icons */
    .icon {
      display: inline-block;
      vertical-align: middle;
    }
  </style>
</head>

<body>
  <!-- ========== MENU VIEW ========== -->
  <div id="menu-view" class="menu-view">
    <header class="header">
      <div class="header-content">
        <div class="logo-section">
          <div class="logo-icon">üçî</div>
          <div class="logo-text">
            <h1>NR Lanchonete</h1>
            <p>Seu lanche favorito üçî</p>
          </div>
        </div>
        <button class="cart-button" onclick="showCart()">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="8" cy="21" r="1"/><circle cx="19" cy="21" r="1"/>
            <path d="M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12"/>
          </svg>
          <span id="cart-badge" class="cart-badge">0</span>
        </button>
      </div>
    </header>

    <div class="categories">
      <div class="categories-inner">
        <button class="category-btn active" onclick="filterCategory(null, this)">Todos</button>
        <button class="category-btn" onclick="filterCategory(0, this)">üçî Lanches</button>
        <button class="category-btn" onclick="filterCategory(1, this)">ü•§ Bebidas</button>
        <button class="category-btn" onclick="filterCategory(2, this)">üç∞ Sobremesas</button>
      </div>
    </div>

    <main class="menu-container">
      <div id="menu-list" class="menu-list"></div>
    </main>

    <div id="floating-cart" class="floating-cart">
      <button class="floating-cart-btn" onclick="showCart()">
        <div class="floating-cart-left">
          <div class="floating-cart-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="8" cy="21" r="1"/><circle cx="19" cy="21" r="1"/>
              <path d="M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12"/>
            </svg>
            <span id="floating-badge" class="floating-cart-badge">0</span>
          </div>
          <span class="floating-cart-text">Ver Carrinho</span>
        </div>
        <span id="floating-total" class="floating-cart-total">R$ 0,00</span>
      </button>
    </div>
  </div>

  <!-- ========== CART VIEW ========== -->
  <div id="cart-view" class="cart-view">
    <header class="cart-header">
      <div class="cart-header-content">
        <button class="back-btn" onclick="showMenu()">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="m12 19-7-7 7-7"/><path d="M19 12H5"/>
          </svg>
        </button>
        <div>
          <h2>Seu Pedido</h2>
          <p id="cart-count-text">0 itens</p>
        </div>
      </div>
    </header>

    <!-- Empty Cart -->
    <div id="empty-cart" class="empty-cart">
      <div class="empty-cart-icon">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z"/>
          <path d="M3 6h18"/><path d="M16 10a4 4 0 0 1-8 0"/>
        </svg>
      </div>
      <h3>Carrinho vazio</h3>
      <p>Adicione itens deliciosos ao seu pedido!</p>
      <button class="empty-cart-btn" onclick="showMenu()">Ver Card√°pio</button>
    </div>

    <!-- Cart Content -->
    <div id="cart-content" class="cart-content">
      <!-- Cart Items -->
      <div class="cart-section">
        <div id="cart-items"></div>
      </div>

      <!-- Retirada -->
      <div class="cart-section">
        <div class="cart-section-title">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/>
            <circle cx="12" cy="10" r="3"/>
          </svg>
          Retirada
        </div>
        <div class="options-grid">
          <button class="option-btn active" onclick="setRetirada('Balc√£o', this)">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z"/>
              <path d="M3 6h18"/><path d="M16 10a4 4 0 0 1-8 0"/>
            </svg>
            <span>Balc√£o</span>
          </button>
          <button class="option-btn" onclick="setRetirada('Delivery', this)">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2"/>
              <path d="M15 18H9"/><path d="M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14"/>
              <circle cx="17" cy="18" r="2"/><circle cx="7" cy="18" r="2"/>
            </svg>
            <span>Delivery</span>
          </button>
        </div>
      </div>

      <!-- Pagamento -->
      <div class="cart-section">
        <div class="cart-section-title">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <rect width="20" height="14" x="2" y="5" rx="2"/>
            <line x1="2" x2="22" y1="10" y2="10"/>
          </svg>
          Pagamento
        </div>
        <div class="options-grid three">
          <button class="option-btn active" onclick="setPagamento('Pix', this)">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <rect width="5" height="5" x="3" y="3" rx="1"/><rect width="5" height="5" x="16" y="3" rx="1"/>
              <rect width="5" height="5" x="3" y="16" rx="1"/><path d="M21 16h-3a2 2 0 0 0-2 2v3"/>
              <path d="M21 21v.01"/><path d="M12 7v3a2 2 0 0 1-2 2H7"/><path d="M3 12h.01"/><path d="M12 3h.01"/>
              <path d="M12 16v.01"/><path d="M16 12h1"/><path d="M21 12v.01"/><path d="M12 21v-1"/>
            </svg>
            <span>Pix</span>
          </button>
          <button class="option-btn" onclick="setPagamento('Cart√£o', this)">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <rect width="20" height="14" x="2" y="5" rx="2"/>
              <line x1="2" x2="22" y1="10" y2="10"/>
            </svg>
            <span>Cart√£o</span>
          </button>
          <button class="option-btn" onclick="setPagamento('Dinheiro', this)">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <rect width="20" height="12" x="2" y="6" rx="2"/>
              <circle cx="12" cy="12" r="2"/><path d="M6 12h.01M18 12h.01"/>
            </svg>
            <span>Dinheiro</span>
          </button>
        </div>
        <input type="text" id="troco-input" class="troco-input" placeholder="Troco para quanto?">
      </div>

      <!-- Totals -->
      <div class="cart-section">
        <div class="total-row">
          <span>Subtotal</span>
          <span id="subtotal">R$ 0,00</span>
        </div>
        <div id="frete-row" class="total-row frete-row">
          <span>Taxa de entrega</span>
          <span id="frete-value">R$ 5,00</span>
        </div>
        <div class="total-row main">
          <span>Total</span>
          <span id="total">R$ 0,00</span>
        </div>
      </div>
    </div>

    <div class="finalize-bar">
      <button class="finalize-btn" onclick="finalizarPedido()">
        <svg viewBox="0 0 24 24" fill="currentColor">
          <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/>
        </svg>
        Finalizar via WhatsApp
      </button>
    </div>
  </div>

  <script type="module">
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js';
    import {
      getFirestore,
      collection,
      getDocs
    } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js';

    // ========== FIREBASE CONFIG ==========
    const firebaseConfig = {
      apiKey: "AIzaSyBItd2aXWE8KXsEjhEFiWNqyBNzpYexuo0",
      authDomain: "nr-lanches.firebaseapp.com",
      projectId: "nr-lanches",
      storageBucket: "nr-lanches.firebasestorage.app",
      messagingSenderId: "896725687818",
      appId: "1:896725687818:web:73d35b2853579bd04309f3"
    };

    initializeApp(firebaseConfig);
    const db = getFirestore();

    // ========== STATE ==========
    const carrinho = {};
    let valorFrete = 5;
    let retirada = 'Balc√£o';
    let pagamento = 'Pix';
    let allItems = [];
    let filteredItems = [];
    const WHATSAPP = '5562982366131';

    // ========== DOM ELEMENTS ==========
    const menuView = document.getElementById('menu-view');
    const cartView = document.getElementById('cart-view');
    const menuList = document.getElementById('menu-list');
    const cartBadge = document.getElementById('cart-badge');
    const floatingCart = document.getElementById('floating-cart');
    const floatingBadge = document.getElementById('floating-badge');
    const floatingTotal = document.getElementById('floating-total');
    const cartItems = document.getElementById('cart-items');
    const cartCountText = document.getElementById('cart-count-text');
    const emptyCart = document.getElementById('empty-cart');
    const cartContent = document.getElementById('cart-content');
    const subtotalEl = document.getElementById('subtotal');
    const freteRow = document.getElementById('frete-row');
    const freteValue = document.getElementById('frete-value');
    const totalEl = document.getElementById('total');
    const trocoInput = document.getElementById('troco-input');

    // ========== HELPERS ==========
    function formatPrice(value) {
      return `R$ ${value.toFixed(2).replace('.', ',')}`;
    }

    function getEmoji(tipo) {
      return tipo === 0 ? 'üçî' : tipo === 1 ? 'ü•§' : 'üç∞';
    }

    function getCategoryName(tipo) {
      return tipo === 0 ? 'Lanche' : tipo === 1 ? 'Bebida' : 'Sobremesa';
    }

    function keyItem(item, combo) {
      return `${item.nome}::${combo ? 'combo' : 'normal'}`;
    }

    // ========== LOAD DATA ==========
    async function carregarFrete() {
      try {
        const snap = await getDocs(collection(db, 'configuracao'));
        snap.forEach(d => {
          valorFrete = d.data().frete || 5;
        });
        freteValue.textContent = formatPrice(valorFrete);
      } catch (e) {
        console.log('Usando frete padr√£o');
      }
    }

    async function carregarCardapio() {
      try {
        const snap = await getDocs(collection(db, 'lanches'));
        allItems = [];
        snap.forEach(d => allItems.push(d.data()));
        allItems.sort((a, b) => a.tipo - b.tipo);
        filteredItems = [...allItems];
        renderMenu();
      } catch (e) {
        console.error('Erro ao carregar card√°pio:', e);
      }
    }

    // ========== RENDER MENU ==========
    function renderMenu() {
      menuList.innerHTML = filteredItems.map((item, index) => `
        <div class="menu-card" style="animation-delay: ${index * 0.05}s">
          <div class="card-emoji">${getEmoji(item.tipo)}</div>
          <div class="card-content">
            <div class="card-category">${getCategoryName(item.tipo)}</div>
            <div class="card-name">${item.nome}</div>
            ${item.descricao ? `<div class="card-description">${item.descricao}</div>` : ''}
            
            <div class="price-row">
              <span class="price">${formatPrice(item.valor)}</span>
              <button class="add-btn normal" onclick='addItem(${JSON.stringify(item).replace(/'/g, "\\'")}, false)'>
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M5 12h14"/><path d="M12 5v14"/>
                </svg>
                Normal
              </button>
            </div>

            ${item.valor_combo ? `
              ${item.descricao_combo ? `<div class="combo-description">${item.descricao_combo}</div>` : ''}
              <div class="price-row combo-separator">
                <span class="price combo">${formatPrice(item.valor_combo)}</span>
                <button class="add-btn combo" onclick='addItem(${JSON.stringify(item).replace(/'/g, "\\'")}, true)'>
                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M5 12h14"/><path d="M12 5v14"/>
                  </svg>
                  Combo
                </button>
              </div>
            ` : ''}
          </div>
        </div>
      `).join('');
    }

    // ========== FILTER ==========
    window.filterCategory = function(tipo, btn) {
      document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      
      if (tipo === null) {
        filteredItems = [...allItems];
      } else {
        filteredItems = allItems.filter(item => item.tipo === tipo);
      }
      renderMenu();
    };

    // ========== CART FUNCTIONS ==========
    window.addItem = function(item, combo) {
      const key = keyItem(item, combo);
      if (!carrinho[key]) {
        carrinho[key] = {
          nome: item.nome,
          combo,
          valor: combo ? item.valor_combo : item.valor,
          qtd: 0
        };
      }
      carrinho[key].qtd++;
      updateCartUI();
    };

    window.changeQty = function(key, delta) {
      if (carrinho[key]) {
        carrinho[key].qtd += delta;
        if (carrinho[key].qtd <= 0) {
          delete carrinho[key];
        }
      }
      updateCartUI();
      renderCartItems();
    };

    function updateCartUI() {
      const items = Object.values(carrinho);
      const totalQtd = items.reduce((s, i) => s + i.qtd, 0);
      const totalValue = items.reduce((s, i) => s + i.qtd * i.valor, 0);

      // Update badges
      cartBadge.textContent = totalQtd;
      cartBadge.classList.toggle('show', totalQtd > 0);
      floatingBadge.textContent = totalQtd;
      floatingTotal.textContent = formatPrice(totalValue);
      floatingCart.classList.toggle('show', totalQtd > 0);
    }

    function renderCartItems() {
      const items = Object.entries(carrinho);
      const totalQtd = items.reduce((s, [, i]) => s + i.qtd, 0);
      
      cartCountText.textContent = `${totalQtd} ${totalQtd === 1 ? 'item' : 'itens'}`;
      
      const isEmpty = items.length === 0;
      emptyCart.classList.toggle('show', isEmpty);
      cartContent.style.display = isEmpty ? 'none' : 'block';
      
      if (isEmpty) return;

      cartItems.innerHTML = items.map(([key, item]) => {
        const subtotal = item.qtd * item.valor;
        return `
          <div class="cart-item">
            <div class="cart-item-info">
              <div class="cart-item-name">${item.nome}</div>
              ${item.combo ? '<span class="cart-item-combo-badge">Combo</span>' : ''}
              <div class="cart-item-unit-price">${formatPrice(item.valor)} cada</div>
            </div>
            <div class="cart-item-actions">
              <button class="qty-btn minus ${item.qtd === 1 ? 'delete' : ''}" onclick="changeQty('${key}', -1)">
                ${item.qtd === 1 ? 'üóëÔ∏è' : '‚àí'}
              </button>
              <span class="qty-value">${item.qtd}</span>
              <button class="qty-btn plus" onclick="changeQty('${key}', 1)">+</button>
            </div>
            <div class="cart-item-subtotal">${formatPrice(subtotal)}</div>
          </div>
        `;
      }).join('');

      updateTotals();
    }

    function updateTotals() {
      const items = Object.values(carrinho);
      const subtotal = items.reduce((s, i) => s + i.qtd * i.valor, 0);
      const isDelivery = retirada === 'Delivery';
      const total = subtotal + (isDelivery ? valorFrete : 0);

      subtotalEl.textContent = formatPrice(subtotal);
      freteRow.classList.toggle('show', isDelivery);
      totalEl.textContent = formatPrice(total);
    }

    // ========== VIEWS ==========
    window.showCart = function() {
      menuView.classList.add('hide');
      cartView.classList.add('show');
      renderCartItems();
    };

    window.showMenu = function() {
      menuView.classList.remove('hide');
      cartView.classList.remove('show');
    };

    // ========== OPTIONS ==========
    window.setRetirada = function(value, btn) {
      retirada = value;
      btn.parentElement.querySelectorAll('.option-btn').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      updateTotals();
    };

    window.setPagamento = function(value, btn) {
      pagamento = value;
      btn.parentElement.querySelectorAll('.option-btn').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      trocoInput.classList.toggle('show', value === 'Dinheiro');
    };

    // ========== FINALIZE ==========
    window.finalizarPedido = function() {
      const items = Object.values(carrinho);
      if (items.length === 0) return;

      const isDelivery = retirada === 'Delivery';
      const subtotal = items.reduce((s, i) => s + i.qtd * i.valor, 0);
      const total = subtotal + (isDelivery ? valorFrete : 0);
      const troco = trocoInput.value;

      let msg = 'üçî *Novo Pedido - NR Lanchonete*\n';
      msg += '‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n\n';

      items.forEach(item => {
        msg += `‚úì ${item.qtd}x ${item.nome}${item.combo ? ' _(Combo)_' : ''}\n`;
        msg += `   ${formatPrice(item.qtd * item.valor)}\n\n`;
      });

      msg += '‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n';

      if (isDelivery) {
        msg += `üöö Frete: ${formatPrice(valorFrete)}\n`;
      }

      msg += `üí∞ *Total: ${formatPrice(total)}*\n\n`;
      msg += `üìç Retirada: ${retirada}\n`;
      msg += `üí≥ Pagamento: ${pagamento}\n`;

      if (pagamento === 'Dinheiro' && troco) {
        msg += `üíµ Troco para: R$ ${troco}\n`;
      }

      window.open(`https://wa.me/${WHATSAPP}?text=${encodeURIComponent(msg)}`, '_blank');
    };

    // ========== INIT ==========
    document.addEventListener('DOMContentLoaded', async () => {
      await carregarFrete();
      await carregarCardapio();
    });
  </script>
</body>
</html>
